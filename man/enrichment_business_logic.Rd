% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/enrichment_business_logic.R
\name{enrichment_business_logic}
\alias{enrichment_business_logic}
\title{Threshold-free directional enrichment via label permutations (business logic)}
\description{
Computes threshold-free, directional enrichment using \strong{label permutations}
on a signed evidence score \code{s = sign(beta_ivw) * (-log10 p_ivw)}.
}
\details{
Provides:
\itemize{
\item \strong{Global}: ARD vs non-ARD across the full phenome
(returns a single two-sided signed test).
\item \strong{Cause-level (L1/L2/L3)}: comparison modes per cause,
notably \code{"cause_vs_rest_all"} (cause vs rest with global permutations).
}

For each test we report the signed statistic \code{stat_signed}, its permutation
mean/SD, the standardized enrichment score \code{SES_signed}, the two-sided
permutation p-value \code{p_signed}, the BH-adjusted q-value \code{q_signed}, and
(optionally) a retained vector of permutation draws for visualization.
}
\section{Expected \code{results_df} columns}{

Required: \code{results_outcome} (chr), \code{results_beta_ivw} (dbl),
\code{results_p_ivw} (dbl in (0,1]), \code{ARD_selected} (logical),
\code{cause_level_1/2/3} (chr; NA allowed).

Strongly recommended: \code{results_qc_pass} (lgl), \code{results_nsnp_after} (int),
\code{results_se_ivw} (dbl; enables weights), \code{pheno_sex} (chr in
{"male","female","both_sex"}).
}

\section{Inference}{

Non-parametric; no normality assumed. Null = exchangeability of labels under the
permutation scope (global / within-cause / among-ARD-only). BH is applied per
tested family (per tail and for the signed test).
}

\keyword{ARD}
\keyword{MR}
\keyword{enrichment}
\keyword{permutation}

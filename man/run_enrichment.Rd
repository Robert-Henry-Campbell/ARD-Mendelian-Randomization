% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/enrichment_business_logic.R
\name{run_enrichment}
\alias{run_enrichment}
\title{Run all enrichment analyses for one exposure}
\usage{
run_enrichment(
  results_df,
  exposure = .default_exposure(),
  levels = c("cause_level_1", "cause_level_2", "cause_level_3"),
  modes = c("cause_vs_rest_all"),
  use_qc_pass = TRUE,
  min_nsnp = 2,
  weight_scheme = c("inv_se2", "none"),
  exact_max_combn = 1e+05,
  mc_B = 10000,
  seed = NULL,
  retain_permutations = FALSE,
  retain_perm_max = 10000
)
}
\arguments{
\item{results_df}{Tidy MR results for the exposure.}

\item{exposure}{Character exposure label. Defaults to \code{exposure_snps$id.exposure} if discoverable.}

\item{levels}{Character vector among \code{c("cause_level_1","cause_level_2","cause_level_3")}.}

\item{modes}{Character vector among the three compare modes (see details).}

\item{use_qc_pass}{Logical; if TRUE and present, filter \code{results_qc_pass==TRUE}.}

\item{min_nsnp}{Integer; if present, filter \code{results_nsnp_after >= min_nsnp}.}

\item{weight_scheme}{Weighting scheme; defaults to \code{"inv_se2"}
(1/SE^2, requires \code{results_se_ivw}) with \code{"none"}
available as a fallback.}

\item{exact_max_combn}{Maximum \eqn{choose(n,a)} for exact enumeration; otherwise Monte Carlo.}

\item{mc_B}{Monte Carlo permutations if not exact.}

\item{seed}{RNG seed.}

\item{retain_permutations}{Logical; if TRUE, keep up to \code{retain_perm_max}
permutation draws per test (for plotting).}

\item{retain_perm_max}{Maximum number of permutation draws to retain when
\code{retain_permutations = TRUE}.}
}
\value{
A list with: \code{$global_tbl} and \code{$by_cause_tbl} (all levels Ã— modes concatenated).
}
\description{
Orchestrates:
\itemize{
\item Global ARD vs non-ARD (tails + single signed).
\item Cause-level L1/L2/L3 with the three comparison modes (tails + signed).
}
}

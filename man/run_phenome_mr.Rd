% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/run_phenome_mr.R
\name{run_phenome_mr}
\alias{run_phenome_mr}
\title{Run phenome-wide MR across phenotypes (orchestrator)}
\usage{
run_phenome_mr(
  exposure,
  exposure_snps,
  exposure_units,
  ancestry,
  sex = c("both", "male", "female"),
  sensitivity_enabled = c("egger_intercept", "egger_slope_agreement", "weighted_median",
    "weighted_mode", "steiger_direction", "leave_one_out", "ivw_Q", "ivw_I2"),
  sensitivity_pass_min = 6,
  Multiple_testing_correction = c("BH", "bonferroni"),
  scatterplot = TRUE,
  snpforestplot = TRUE,
  leaveoneoutplot = TRUE,
  cache_dir = ardmr_cache_dir(),
  logfile = NULL,
  verbose = TRUE,
  confirm = "ask",
  force_refresh = TRUE
)
}
\arguments{
\item{exposure}{Character (mandatory) label for the exposure; used for
naming output directories and plot titles.}

\item{exposure_snps}{Data frame of exposure instruments (TwoSampleMR-like). needs cols:
\link{1} "id.exposure"           "Exposure"                "SNP" (must be rsid format) "Chr"
\link{5} "Pos"                    "effect_allele.exposure" "other_allele.exposure"  "eaf.exposure"
\link{9} "beta.exposure"          "se.exposure"            "palindromic"            "pval.exposure"
\link{13} "mr_keep"                "F"}

\item{exposure_units}{Character (mandatory) description of the exposure
units for Î²-scale plots.}

\item{ancestry}{Character (mandatory), e.g. "EUR".}

\item{sex}{One of "both","male","female". If not "both", you likely use Neale.}

\item{sensitivity_enabled}{Character vector of checks (default = all 8).}

\item{sensitivity_pass_min}{Integer threshold to pass QC (default 6).}

\item{Multiple_testing_correction}{"BH" or "bonferroni" (default "BH").}

\item{scatterplot, snpforestplot, leaveoneoutplot}{Logical; produce per-outcome diagnostics.}

\item{cache_dir}{Cache directory for temporary files (default:
\code{\link[=ardmr_cache_dir]{ardmr_cache_dir()}}).}

\item{logfile}{Optional path to log file. Defaults to a timestamped file in
\code{cache_dir} if not supplied.}

\item{verbose}{Logical; if \code{FALSE}, only warnings/errors are logged.}

\item{confirm}{Character; whether to prompt before downloading required
resources when using Neale data. One of "ask", "yes", or "no".}

\item{force_refresh}{Logical; if \code{TRUE}, re-download remote resources even if
they are already cached. Defaults to \code{TRUE}.}

\item{Neale_GWAS_dir}{Optional path to Neale sumstats; created if missing.}
}
\value{
A list: MR_df, results_df, manhattan (ggplot), volcano (ggplot)
}
\description{
Builds the outcome plan, maps exposure SNPs, fetches outcome SNP rows,
runs MR + sensitivity/QC, and returns results + plots. Phenotypes flagged by
\code{ARD_selected} denote age-related diseases.
}
